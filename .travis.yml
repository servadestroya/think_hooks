language: cpp
compiler:
    - gcc
#sudo: false
addons:
    apt:
        packages:
        - lib32stdc++6
        - lib32z1-dev
        - libc6-dev-i386
        - linux-libc-dev
        
        - lib32gcc-5-dev
        - libgcc-5-dev
        - g++-5-multilib
        - gcc-5-multilib
        - g++-5
        - gcc-5
        sources:
            - ubuntu-toolchain-r-test
    cache:
        directories:
            - ../mysql-5.0
    
install:
    - git clone https://github.com/alliedmodders/sourcemod.git --recursive -b 1.8-dev $TRAVIS_BUILD_DIR/../sourcemod
    - cd $TRAVIS_BUILD_DIR/../
    - wget https://raw.githubusercontent.com/alliedmodders/sourcemod/master/tools/checkout-deps.sh && chmod +x checkout-deps.sh
    - ./checkout-deps.sh
    - sudo ln -s /usr/include/asm-generic /usr/include/asm
    
script:
    - mkdir $TRAVIS_BUILD_DIR/build && cd $TRAVIS_BUILD_DIR/build
    - CXX=g++-5 CC=gcc-5 python ../configure.py --enable-optimize
    - ambuild
